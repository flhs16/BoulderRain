# 巨石雨 (BoulderRain)

一个为TShock服务器开发的Terraria插件，能够生成大量下落的巨石弹幕，为游戏增添趣味性和挑战性。

## 功能特点

- 可配置的弹幕生成参数
- 支持追踪模式，可追踪怪物或玩家
- 灵活的权限控制
- 实时配置重载功能
- 完整的命令系统
- 详细的日志记录

## 安装方法

1. 确保已安装TShock服务器
2. 将`RockRain.dll`放入TShock的`ServerPlugins`目录
3. 启动服务器，插件会自动创建默认配置文件
4. 根据需要修改配置文件`RockRain.json`

## 配置说明

配置文件位于TShock目录下的`RockRain.json`，包含以下主要配置项：

### 默认弹幕配置

| 配置项 | 说明 | 默认值 |
|--------|------|--------|
| 弹幕ID | 使用的弹幕类型ID | 99 |
| 下落速度 | 弹幕下落的基础速度 | 10.0 |
| 伤害 | 弹幕造成的伤害值 | 50 |
| 击退 | 弹幕的击退效果 | 5.0 |
| 持续时间 | 效果持续的总时间(帧) | 1800 |
| 生成间隔 | 弹幕生成的时间间隔(帧) | 10 |
| 生成高度 | 弹幕生成的起始高度 | 600.0 |
| 生成范围 | 弹幕生成的横向范围 | 1000.0 |
| 追踪模式 | 是否启用追踪功能 | false |
| 追踪目标 | 追踪的目标类型(0:无, 1:怪物, 2:玩家) | 1 |
| 追踪速度 | 追踪时的移动速度 | 5.0 |
| 追踪范围 | 开始追踪的距离范围 | 500.0 |
| 生命周期 | 弹幕的生命周期(帧) | 300 |
| 每帧更新次数 | 每帧生成的弹幕数量 | 0 |

### 全局配置

| 配置项 | 说明 | 默认值 |
|--------|------|--------|
| 调试模式 | 是否启用调试日志 | false |
| 最大生成数量 | 同时存在的最大效果数量 | 10 |
| 玩家加入自动开启 | 玩家加入时是否自动开启效果 | false |

## 命令说明

插件使用`/rm`（RockRain的缩写）作为主命令：

| 命令 | 功能 | 权限要求 |
|------|------|----------|
| `/rm help` | 显示帮助信息 | 所有玩家 |
| `/rm start` | 开始巨石雨效果 | 管理员 |
| `/rm stop` | 停止巨石雨效果 | 管理员 |
| `/rm set` | 查看当前弹幕属性设置 | 管理员 |
| `/rm set <属性> <值>` | 设置弹幕属性（临时配置） | 管理员 |
| `/rm reload` | 重载配置文件 | 管理员 |

## 属性说明

使用`/rm set`命令可以设置的属性包括：

| 属性名 | 说明 | 类型 |
|--------|------|------|
| speed | 下落速度 | 浮点数 |
| damage | 伤害值 | 整数 |
| knockback | 击退效果 | 浮点数 |
| duration | 持续时间 | 整数 |
| interval | 生成间隔 | 整数 |
| height | 生成高度 | 浮点数 |
| range | 生成范围 | 浮点数 |
| tracking | 追踪模式 | 布尔值 |
| target | 追踪目标 | 整数 |
| trackspeed | 追踪速度 | 浮点数 |
| trackrange | 追踪范围 | 浮点数 |
| lifetime | 生命周期 | 整数 |
| updates | 每帧更新次数 | 整数 |

## 追踪目标类型

| 值 | 目标类型 |
|-----|----------|
| 0 | 无（不追踪） |
| 1 | 怪物 |
| 2 | 玩家 |

## 默认配置

```json
{
  "默认弹幕配置": {
    "弹幕ID": 99,
    "下落速度": 10.0,
    "伤害": 50,
    "击退": 5.0,
    "持续时间": 1800,
    "生成间隔": 10,
    "生成高度": 600.0,
    "生成范围": 1000.0,
    "追踪模式": false,
    "追踪目标": 1,
    "追踪速度": 5.0,
    "追踪范围": 500.0,
    "生命周期": 300,
    "每帧更新次数": 0
  },
  "调试模式": false,
  "最大生成数量": 10,
  "玩家加入自动开启": false
}
```

## 示例用法

1. 开始巨石雨效果：
   ```
   /rm start
   ```

2. 设置弹幕伤害为100：
   ```
   /rm set damage 100
   ```

3. 启用追踪模式并设置追踪速度为8：
   ```
   /rm set tracking true
   /rm set trackspeed 8
   ```

4. 重载配置文件：
   ```
   /rm reload
   ```

## 权限

| 权限 | 说明 |
|------|------|
| rockrain.admin | 允许使用管理员命令 |

## 作者

天子 (TianZi)

## 版本

v1.0.0

## 注意事项

- 使用过高的生成频率或数量可能会影响服务器性能
- 请根据服务器配置和玩家数量合理调整参数
- 调试模式会产生大量日志，请在调试完成后关闭
- 插件在大型服务器上使用时建议进行性能测试